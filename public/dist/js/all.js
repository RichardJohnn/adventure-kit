(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var Pixel = require('./pixel');

var DrawSurface = function DrawSurface(container, params) {
  params || (params = {});
  this.container = container;
  if (!this.container) {
    throw new Exception('DrawSurface requires a container parameter.');
  }

  this.width = params.width || 512;
  this.height = params.height || 512;
  this.tileSize = params.tileSize || 32;
  this.bgTileSize = params.bgTileSize || 8;

  this.setupCanvas();
  this.drawBackground();
  this.initDrawSurface();

  this.container.addEventListener('mousemove', this.highlightPixel.bind(this), false);
  this.container.addEventListener('mouseout', this.clearHighlight.bind(this), false);
  this.container.addEventListener('mousedown', this.paintPixel.bind(this), false);
};

DrawSurface.prototype.setupCanvas = function () {
  this.bgCanvas = document.createElement('canvas');
  this.bgCanvas.setAttribute('width', this.width);
  this.bgCanvas.setAttribute('height', this.height);
  this.container.appendChild(this.bgCanvas);

  this.drawCanvas = document.createElement('canvas');
  this.drawCanvas.setAttribute('width', this.width);
  this.drawCanvas.setAttribute('height', this.height);
  this.container.appendChild(this.drawCanvas);

  this.overlayCanvas = document.createElement('canvas');
  this.overlayCanvas.setAttribute('width', this.width);
  this.overlayCanvas.setAttribute('height', this.height);
  this.container.appendChild(this.overlayCanvas);

  this.bgCtx = this.bgCanvas.getContext('2d');
  this.drawCtx = this.drawCanvas.getContext('2d');
  this.overlayCtx = this.overlayCanvas.getContext('2d');
};

DrawSurface.prototype.drawBackground = function () {
  var numTilesHoriz = this.width / this.bgTileSize;
  var numTilesVert = this.height / this.bgTileSize;

  for (var i = 0; i < numTilesHoriz; i++) {
    for (var j = 0; j < numTilesVert; j++) {
      var x = i * this.bgTileSize;
      var y = j * this.bgTileSize;

      var fill = (i + j) % 2 == 0 ? '#999' : '#777';

      this.bgCtx.fillStyle = fill;
      this.bgCtx.fillRect(x, y, this.bgTileSize, this.bgTileSize);
    }
  }
};

DrawSurface.prototype.initDrawSurface = function () {
  var numPixelsHoriz = this.width / this.tileSize;
  var numPixelsVert = this.height / this.tileSize;
  this.grid = [];

  for (var x = 0; x < numPixelsHoriz; x++) {
    this.grid[x] = [];

    for (var y = 0; y < numPixelsVert; y++) {
      this.grid[x].push(new Pixel(x, y));
    }
  }
};

DrawSurface.prototype.getPixelCoordinates = function (ev) {
  var elRect = ev.target.getBoundingClientRect();
  var absX = ev.clientX;
  var absY = ev.clientY;
  var x = absX - elRect.left;
  var y = absY - elRect.top;

  var pixelX = Math.floor(x / this.tileSize);
  var pixelY = Math.floor(y / this.tileSize);

  return { x: pixelX, y: pixelY };
};

DrawSurface.prototype.highlightPixel = function (ev) {
  var coords = this.getPixelCoordinates(ev);
  var x = coords.x;
  var y = coords.y;
  var numPixels = this.grid.length;

  var currentPixel = this.grid[x][y];
  if (!currentPixel.highlighted) {
    var fillX = currentPixel.x * this.tileSize;
    var fillY = currentPixel.y * this.tileSize;

    this.overlayCtx.fillStyle = 'rgba(255, 255, 255, 0.2)';
    this.overlayCtx.fillRect(fillX, fillY, this.tileSize, this.tileSize);
    currentPixel.highlighted = true;
  }

  this.clearHighlight(null, currentPixel);
};

DrawSurface.prototype.clearHighlight = function (ev, currentPixel) {
  var numPixelsHoriz = this.width / this.tileSize;
  var numPixelsVert = this.height / this.tileSize;
  for (var ix = 0; ix < numPixelsHoriz; ix++) {
    for (var iy = 0; iy < numPixelsVert; iy++) {
      var pixel = this.grid[ix][iy];
      if (pixel === currentPixel) {
        continue;
      }

      if (pixel.highlighted) {
        var clrX = pixel.x * this.tileSize;
        var clrY = pixel.y * this.tileSize;

        this.overlayCtx.clearRect(clrX, clrY, this.tileSize, this.tileSize);
        pixel.highlighted = false;
      }
    }
  }
};

DrawSurface.prototype.paintPixel = function (ev) {
  var coords = this.getPixelCoordinates(ev);
  var x = coords.x;
  var y = coords.y;
  var color = '#000000';
  var pixel = this.grid[x][y];

  var fillX = x * this.tileSize;
  var fillY = y * this.tileSize;
  this.drawCtx.fillStyle = color;
  this.drawCtx.fillRect(fillX, fillY, this.tileSize, this.tileSize);
  pixel.color = color;
};

exports = module.exports = DrawSurface;

},{"./pixel":3}],2:[function(require,module,exports){
"use strict";

var FileHandler = function FileHandler(el) {
  this.el = el;
};

exports = module.exports = FileHandler;

},{}],3:[function(require,module,exports){
"use strict";

var Pixel = function Pixel(x, y) {
  this.x = x;
  this.y = y;
  this.highlighted = false;
  this.color = null;
};

exports = module.exports = Pixel;

},{}],4:[function(require,module,exports){
'use strict';

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _draw_surface = require('./draw_surface');

var _draw_surface2 = _interopRequireDefault(_draw_surface);

var _file_handler = require('./file_handler');

var _file_handler2 = _interopRequireDefault(_file_handler);

document.addEventListener('DOMContentLoaded', function () {
  var drawContainer = document.getElementById('tile-map');
  var drawSurface = new _draw_surface2['default'](drawContainer);

  var tmxFileHandler = new _file_handler2['default'](document.getElementById('tmx-file'));
});

},{"./draw_surface":1,"./file_handler":2}]},{},[4])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvaG9tZS9hdXN0aW4vcHJvamVjdHMvYWR2ZW50dXJlLWtpdC9wdWJsaWMvanMvZHJhd19zdXJmYWNlLmpzIiwiL2hvbWUvYXVzdGluL3Byb2plY3RzL2FkdmVudHVyZS1raXQvcHVibGljL2pzL2ZpbGVfaGFuZGxlci5qcyIsIi9ob21lL2F1c3Rpbi9wcm9qZWN0cy9hZHZlbnR1cmUta2l0L3B1YmxpYy9qcy9waXhlbC5qcyIsIi9ob21lL2F1c3Rpbi9wcm9qZWN0cy9hZHZlbnR1cmUta2l0L3B1YmxpYy9qcy9hcHAuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQUksS0FBSyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQzs7QUFFL0IsSUFBSSxXQUFXLEdBQUcsU0FBZCxXQUFXLENBQWEsU0FBUyxFQUFFLE1BQU0sRUFBRTtBQUM3QyxRQUFNLEtBQUssTUFBTSxHQUFHLEVBQUUsQ0FBQSxBQUFDLENBQUM7QUFDeEIsTUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7QUFDM0IsTUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUU7QUFDbkIsVUFBTSxJQUFJLFNBQVMsQ0FBQyw2Q0FBNkMsQ0FBQyxDQUFDO0dBQ3BFOztBQUVELE1BQUksQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssSUFBSSxHQUFHLENBQUM7QUFDakMsTUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQUcsQ0FBQztBQUNuQyxNQUFJLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDO0FBQ3RDLE1BQUksQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLFVBQVUsSUFBSSxDQUFDLENBQUM7O0FBRXpDLE1BQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUNuQixNQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7QUFDdEIsTUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDOztBQUV2QixNQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFDM0MsS0FBSyxDQUFDLENBQUM7QUFDdkMsTUFBSSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQzFDLEtBQUssQ0FBQyxDQUFDO0FBQ3ZDLE1BQUksQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUN2QyxLQUFLLENBQUMsQ0FBQztDQUN4QyxDQUFDOztBQUVGLFdBQVcsQ0FBQyxTQUFTLENBQUMsV0FBVyxHQUFHLFlBQVk7QUFDOUMsTUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2pELE1BQUksQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDaEQsTUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNsRCxNQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7O0FBRTFDLE1BQUksQ0FBQyxVQUFVLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNuRCxNQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ2xELE1BQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDcEQsTUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDOztBQUU1QyxNQUFJLENBQUMsYUFBYSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDdEQsTUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNyRCxNQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3ZELE1BQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQzs7QUFFL0MsTUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM1QyxNQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2hELE1BQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7Q0FDdkQsQ0FBQzs7QUFFRixXQUFXLENBQUMsU0FBUyxDQUFDLGNBQWMsR0FBRyxZQUFZO0FBQ2pELE1BQUksYUFBYSxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztBQUNqRCxNQUFJLFlBQVksR0FBRyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7O0FBRWpELE9BQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxhQUFhLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDdEMsU0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRTtBQUNyQyxVQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztBQUM1QixVQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQzs7QUFFNUIsVUFBSSxJQUFJLEdBQUcsQUFBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUEsR0FBSSxDQUFDLElBQUksQ0FBQyxHQUFJLE1BQU0sR0FBRyxNQUFNLENBQUM7O0FBRWhELFVBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztBQUM1QixVQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQzdEO0dBQ0Y7Q0FDRixDQUFDOztBQUVGLFdBQVcsQ0FBQyxTQUFTLENBQUMsZUFBZSxHQUFHLFlBQVk7QUFDbEQsTUFBSSxjQUFjLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO0FBQ2hELE1BQUksYUFBYSxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQztBQUNoRCxNQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQzs7QUFFZixPQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsY0FBYyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ3ZDLFFBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDOztBQUVsQixTQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ3RDLFVBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3BDO0dBQ0Y7Q0FDRixDQUFBOztBQUVELFdBQVcsQ0FBQyxTQUFTLENBQUMsbUJBQW1CLEdBQUcsVUFBVSxFQUFFLEVBQUU7QUFDeEQsTUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO0FBQy9DLE1BQUksSUFBSSxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUM7QUFDdEIsTUFBSSxJQUFJLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQztBQUN0QixNQUFJLENBQUMsR0FBRyxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQztBQUMzQixNQUFJLENBQUMsR0FBRyxJQUFJLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQzs7QUFFMUIsTUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzNDLE1BQUksTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQzs7QUFFM0MsU0FBTyxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDO0NBQ2pDLENBQUE7O0FBRUQsV0FBVyxDQUFDLFNBQVMsQ0FBQyxjQUFjLEdBQUcsVUFBVSxFQUFFLEVBQUU7QUFDbkQsTUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzFDLE1BQUksQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDakIsTUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNqQixNQUFJLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQzs7QUFFakMsTUFBSSxZQUFZLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNuQyxNQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsRUFBRTtBQUM3QixRQUFJLEtBQUssR0FBRyxZQUFZLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7QUFDM0MsUUFBSSxLQUFLLEdBQUcsWUFBWSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDOztBQUUzQyxRQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsR0FBRywwQkFBMEIsQ0FBQztBQUN2RCxRQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3JFLGdCQUFZLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztHQUNqQzs7QUFFRCxNQUFJLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsQ0FBQztDQUN6QyxDQUFDOztBQUVGLFdBQVcsQ0FBQyxTQUFTLENBQUMsY0FBYyxHQUFHLFVBQVUsRUFBRSxFQUFFLFlBQVksRUFBRTtBQUNqRSxNQUFJLGNBQWMsR0FBRyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7QUFDaEQsTUFBSSxhQUFhLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO0FBQ2hELE9BQUssSUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFLEVBQUUsR0FBRyxjQUFjLEVBQUUsRUFBRSxFQUFFLEVBQUU7QUFDMUMsU0FBSyxJQUFJLEVBQUUsR0FBRyxDQUFDLEVBQUUsRUFBRSxHQUFHLGFBQWEsRUFBRSxFQUFFLEVBQUUsRUFBRTtBQUN6QyxVQUFJLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzlCLFVBQUksS0FBSyxLQUFLLFlBQVksRUFBRTtBQUMxQixpQkFBUztPQUNWOztBQUVELFVBQUksS0FBSyxDQUFDLFdBQVcsRUFBRTtBQUNyQixZQUFJLElBQUksR0FBRyxLQUFLLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7QUFDbkMsWUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDOztBQUVuQyxZQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3BFLGFBQUssQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO09BQzNCO0tBQ0Y7R0FDRjtDQUNGLENBQUM7O0FBRUYsV0FBVyxDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUcsVUFBVSxFQUFFLEVBQUU7QUFDL0MsTUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzFDLE1BQUksQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDakIsTUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNqQixNQUFJLEtBQUssR0FBRyxTQUFTLENBQUM7QUFDdEIsTUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzs7QUFFNUIsTUFBSSxLQUFLLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7QUFDOUIsTUFBSSxLQUFLLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7QUFDOUIsTUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0FBQy9CLE1BQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDbEUsT0FBSyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7Q0FDckIsQ0FBQzs7QUFFRixPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sR0FBRyxXQUFXLENBQUM7Ozs7O0FDakp2QyxJQUFJLFdBQVcsR0FBRyxTQUFkLFdBQVcsQ0FBYSxFQUFFLEVBQUU7QUFDOUIsTUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUM7Q0FDZCxDQUFDOztBQUVGLE9BQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQzs7Ozs7QUNKdkMsSUFBSSxLQUFLLEdBQUcsU0FBUixLQUFLLENBQWEsQ0FBQyxFQUFFLENBQUMsRUFBRTtBQUMxQixNQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNYLE1BQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ1gsTUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7QUFDekIsTUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7Q0FDbkIsQ0FBQzs7QUFFRixPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7Ozs7Ozs7NEJDUFQsZ0JBQWdCOzs7OzRCQUNoQixnQkFBZ0I7Ozs7QUFFeEMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLGtCQUFrQixFQUFFLFlBQVk7QUFDeEQsTUFBSSxhQUFhLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUN4RCxNQUFJLFdBQVcsR0FBRyw4QkFBZ0IsYUFBYSxDQUFDLENBQUM7O0FBRWpELE1BQUksY0FBYyxHQUFHLDhCQUFnQixRQUFRLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7Q0FDM0UsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBQaXhlbCA9IHJlcXVpcmUoJy4vcGl4ZWwnKTtcblxudmFyIERyYXdTdXJmYWNlID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcGFyYW1zKSB7XG4gIHBhcmFtcyB8fCAocGFyYW1zID0ge30pO1xuICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgaWYgKCF0aGlzLmNvbnRhaW5lcikge1xuICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJEcmF3U3VyZmFjZSByZXF1aXJlcyBhIGNvbnRhaW5lciBwYXJhbWV0ZXIuXCIpO1xuICB9XG5cbiAgdGhpcy53aWR0aCA9IHBhcmFtcy53aWR0aCB8fCA1MTI7XG4gIHRoaXMuaGVpZ2h0ID0gcGFyYW1zLmhlaWdodCB8fCA1MTI7XG4gIHRoaXMudGlsZVNpemUgPSBwYXJhbXMudGlsZVNpemUgfHwgMzI7XG4gIHRoaXMuYmdUaWxlU2l6ZSA9IHBhcmFtcy5iZ1RpbGVTaXplIHx8IDg7XG5cbiAgdGhpcy5zZXR1cENhbnZhcygpO1xuICB0aGlzLmRyYXdCYWNrZ3JvdW5kKCk7XG4gIHRoaXMuaW5pdERyYXdTdXJmYWNlKCk7XG5cbiAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5oaWdobGlnaHRQaXhlbC5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlKTtcbiAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCB0aGlzLmNsZWFySGlnaGxpZ2h0LmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UpO1xuICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLnBhaW50UGl4ZWwuYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSk7XG59O1xuXG5EcmF3U3VyZmFjZS5wcm90b3R5cGUuc2V0dXBDYW52YXMgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuYmdDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgdGhpcy5iZ0NhbnZhcy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgdGhpcy53aWR0aCk7XG4gIHRoaXMuYmdDYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCB0aGlzLmhlaWdodCk7XG4gIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuYmdDYW52YXMpO1xuXG4gIHRoaXMuZHJhd0NhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICB0aGlzLmRyYXdDYW52YXMuc2V0QXR0cmlidXRlKCd3aWR0aCcsIHRoaXMud2lkdGgpO1xuICB0aGlzLmRyYXdDYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCB0aGlzLmhlaWdodCk7XG4gIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZHJhd0NhbnZhcyk7XG5cbiAgdGhpcy5vdmVybGF5Q2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gIHRoaXMub3ZlcmxheUNhbnZhcy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgdGhpcy53aWR0aCk7XG4gIHRoaXMub3ZlcmxheUNhbnZhcy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIHRoaXMuaGVpZ2h0KTtcbiAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5vdmVybGF5Q2FudmFzKTtcblxuICB0aGlzLmJnQ3R4ID0gdGhpcy5iZ0NhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICB0aGlzLmRyYXdDdHggPSB0aGlzLmRyYXdDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgdGhpcy5vdmVybGF5Q3R4ID0gdGhpcy5vdmVybGF5Q2FudmFzLmdldENvbnRleHQoJzJkJyk7XG59O1xuXG5EcmF3U3VyZmFjZS5wcm90b3R5cGUuZHJhd0JhY2tncm91bmQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBudW1UaWxlc0hvcml6ID0gdGhpcy53aWR0aCAvIHRoaXMuYmdUaWxlU2l6ZTtcbiAgdmFyIG51bVRpbGVzVmVydCA9IHRoaXMuaGVpZ2h0IC8gdGhpcy5iZ1RpbGVTaXplO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtVGlsZXNIb3JpejsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1UaWxlc1ZlcnQ7IGorKykge1xuICAgICAgdmFyIHggPSBpICogdGhpcy5iZ1RpbGVTaXplO1xuICAgICAgdmFyIHkgPSBqICogdGhpcy5iZ1RpbGVTaXplO1xuXG4gICAgICB2YXIgZmlsbCA9ICgoaSArIGopICUgMiA9PSAwKSA/IFwiIzk5OVwiIDogXCIjNzc3XCI7XG5cbiAgICAgIHRoaXMuYmdDdHguZmlsbFN0eWxlID0gZmlsbDtcbiAgICAgIHRoaXMuYmdDdHguZmlsbFJlY3QoeCwgeSwgdGhpcy5iZ1RpbGVTaXplLCB0aGlzLmJnVGlsZVNpemUpO1xuICAgIH1cbiAgfVxufTtcblxuRHJhd1N1cmZhY2UucHJvdG90eXBlLmluaXREcmF3U3VyZmFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIG51bVBpeGVsc0hvcml6ID0gdGhpcy53aWR0aCAvIHRoaXMudGlsZVNpemU7XG4gIHZhciBudW1QaXhlbHNWZXJ0ID0gdGhpcy5oZWlnaHQgLyB0aGlzLnRpbGVTaXplO1xuICB0aGlzLmdyaWQgPSBbXTtcblxuICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bVBpeGVsc0hvcml6OyB4KyspIHtcbiAgICB0aGlzLmdyaWRbeF0gPSBbXTtcblxuICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbnVtUGl4ZWxzVmVydDsgeSsrKSB7XG4gICAgICB0aGlzLmdyaWRbeF0ucHVzaChuZXcgUGl4ZWwoeCwgeSkpO1xuICAgIH1cbiAgfVxufVxuXG5EcmF3U3VyZmFjZS5wcm90b3R5cGUuZ2V0UGl4ZWxDb29yZGluYXRlcyA9IGZ1bmN0aW9uIChldikge1xuICB2YXIgZWxSZWN0ID0gZXYudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICB2YXIgYWJzWCA9IGV2LmNsaWVudFg7XG4gIHZhciBhYnNZID0gZXYuY2xpZW50WTtcbiAgdmFyIHggPSBhYnNYIC0gZWxSZWN0LmxlZnQ7XG4gIHZhciB5ID0gYWJzWSAtIGVsUmVjdC50b3A7XG5cbiAgdmFyIHBpeGVsWCA9IE1hdGguZmxvb3IoeCAvIHRoaXMudGlsZVNpemUpO1xuICB2YXIgcGl4ZWxZID0gTWF0aC5mbG9vcih5IC8gdGhpcy50aWxlU2l6ZSk7XG5cbiAgcmV0dXJuIHsgeDogcGl4ZWxYLCB5OiBwaXhlbFkgfTtcbn1cblxuRHJhd1N1cmZhY2UucHJvdG90eXBlLmhpZ2hsaWdodFBpeGVsID0gZnVuY3Rpb24gKGV2KSB7XG4gIHZhciBjb29yZHMgPSB0aGlzLmdldFBpeGVsQ29vcmRpbmF0ZXMoZXYpO1xuICB2YXIgeCA9IGNvb3Jkcy54O1xuICB2YXIgeSA9IGNvb3Jkcy55O1xuICB2YXIgbnVtUGl4ZWxzID0gdGhpcy5ncmlkLmxlbmd0aDtcblxuICB2YXIgY3VycmVudFBpeGVsID0gdGhpcy5ncmlkW3hdW3ldO1xuICBpZiAoIWN1cnJlbnRQaXhlbC5oaWdobGlnaHRlZCkge1xuICAgIHZhciBmaWxsWCA9IGN1cnJlbnRQaXhlbC54ICogdGhpcy50aWxlU2l6ZTtcbiAgICB2YXIgZmlsbFkgPSBjdXJyZW50UGl4ZWwueSAqIHRoaXMudGlsZVNpemU7XG5cbiAgICB0aGlzLm92ZXJsYXlDdHguZmlsbFN0eWxlID0gXCJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMilcIjtcbiAgICB0aGlzLm92ZXJsYXlDdHguZmlsbFJlY3QoZmlsbFgsIGZpbGxZLCB0aGlzLnRpbGVTaXplLCB0aGlzLnRpbGVTaXplKTtcbiAgICBjdXJyZW50UGl4ZWwuaGlnaGxpZ2h0ZWQgPSB0cnVlO1xuICB9XG5cbiAgdGhpcy5jbGVhckhpZ2hsaWdodChudWxsLCBjdXJyZW50UGl4ZWwpO1xufTtcblxuRHJhd1N1cmZhY2UucHJvdG90eXBlLmNsZWFySGlnaGxpZ2h0ID0gZnVuY3Rpb24gKGV2LCBjdXJyZW50UGl4ZWwpIHtcbiAgdmFyIG51bVBpeGVsc0hvcml6ID0gdGhpcy53aWR0aCAvIHRoaXMudGlsZVNpemU7XG4gIHZhciBudW1QaXhlbHNWZXJ0ID0gdGhpcy5oZWlnaHQgLyB0aGlzLnRpbGVTaXplO1xuICBmb3IgKHZhciBpeCA9IDA7IGl4IDwgbnVtUGl4ZWxzSG9yaXo7IGl4KyspIHtcbiAgICBmb3IgKHZhciBpeSA9IDA7IGl5IDwgbnVtUGl4ZWxzVmVydDsgaXkrKykge1xuICAgICAgdmFyIHBpeGVsID0gdGhpcy5ncmlkW2l4XVtpeV07XG4gICAgICBpZiAocGl4ZWwgPT09IGN1cnJlbnRQaXhlbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHBpeGVsLmhpZ2hsaWdodGVkKSB7XG4gICAgICAgIHZhciBjbHJYID0gcGl4ZWwueCAqIHRoaXMudGlsZVNpemU7XG4gICAgICAgIHZhciBjbHJZID0gcGl4ZWwueSAqIHRoaXMudGlsZVNpemU7XG5cbiAgICAgICAgdGhpcy5vdmVybGF5Q3R4LmNsZWFyUmVjdChjbHJYLCBjbHJZLCB0aGlzLnRpbGVTaXplLCB0aGlzLnRpbGVTaXplKTtcbiAgICAgICAgcGl4ZWwuaGlnaGxpZ2h0ZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbkRyYXdTdXJmYWNlLnByb3RvdHlwZS5wYWludFBpeGVsID0gZnVuY3Rpb24gKGV2KSB7XG4gIHZhciBjb29yZHMgPSB0aGlzLmdldFBpeGVsQ29vcmRpbmF0ZXMoZXYpO1xuICB2YXIgeCA9IGNvb3Jkcy54O1xuICB2YXIgeSA9IGNvb3Jkcy55O1xuICB2YXIgY29sb3IgPSBcIiMwMDAwMDBcIjtcbiAgdmFyIHBpeGVsID0gdGhpcy5ncmlkW3hdW3ldO1xuXG4gIHZhciBmaWxsWCA9IHggKiB0aGlzLnRpbGVTaXplO1xuICB2YXIgZmlsbFkgPSB5ICogdGhpcy50aWxlU2l6ZTtcbiAgdGhpcy5kcmF3Q3R4LmZpbGxTdHlsZSA9IGNvbG9yO1xuICB0aGlzLmRyYXdDdHguZmlsbFJlY3QoZmlsbFgsIGZpbGxZLCB0aGlzLnRpbGVTaXplLCB0aGlzLnRpbGVTaXplKTtcbiAgcGl4ZWwuY29sb3IgPSBjb2xvcjtcbn07XG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IERyYXdTdXJmYWNlO1xuIiwidmFyIEZpbGVIYW5kbGVyID0gZnVuY3Rpb24gKGVsKSB7XG4gIHRoaXMuZWwgPSBlbDtcbn07XG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IEZpbGVIYW5kbGVyO1xuIiwidmFyIFBpeGVsID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgdGhpcy54ID0geDtcbiAgdGhpcy55ID0geTtcbiAgdGhpcy5oaWdobGlnaHRlZCA9IGZhbHNlO1xuICB0aGlzLmNvbG9yID0gbnVsbDtcbn07XG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IFBpeGVsO1xuIiwiaW1wb3J0IERyYXdTdXJmYWNlIGZyb20gJy4vZHJhd19zdXJmYWNlJztcbmltcG9ydCBGaWxlSGFuZGxlciBmcm9tICcuL2ZpbGVfaGFuZGxlcic7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGxldCBkcmF3Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbGUtbWFwJyk7XG4gIGxldCBkcmF3U3VyZmFjZSA9IG5ldyBEcmF3U3VyZmFjZShkcmF3Q29udGFpbmVyKTtcblxuICBsZXQgdG14RmlsZUhhbmRsZXIgPSBuZXcgRmlsZUhhbmRsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RteC1maWxlJykpO1xufSk7XG4iXX0=
